- name: Generate SSH key
  hosts: all
  tags: ssh
  gather_facts: false
  become_user: "{{ ansible_user }}"
  tasks:
    - name: Create directory for storing ssh key
      file:
        path: "$HOME/.ssh"
        state: directory
    - name: Generate SSH key with default 4096 bits, rsa
      openssh_keypair:
        path: "$HOME/.ssh/id_rsa"
